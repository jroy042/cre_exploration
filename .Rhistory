library(shinydashboard)
shiny::runApp()
library(tidyverse)
library(readxl)
library(mgcv)
negs = read_excel("negative_code.xlsx")
warnings()
View(negs)
View(negs)
negs = read_excel("negative_code.xlsx")
View(negs)
warnings()
unique(negs$variant)
negs %>% filter(variant != "/") -> negs
gam1 = gam(variant ~ s(date)+relationship, family="binomial")
gam1 = gam(variant ~ s(date)+relationship, family="binomial", data=negs)
negs = read_excel("negative_code.xlsx")
negs %>% filter(variant != "/") %>% mutate(response = ifelse(variant=="D",1,0)) -> negs
negs %>% filter(variant != "/") %>% mutate(variant_y = ifelse(variant=="D",1,0)) -> negs
gam1 = gam(variant_y ~ s(date)+relationship, family="binomial", data=negs)
summary(gam1)
library(visreg)
install.packages("visreg")
library(visreg)
visreg(gam1,"date")
?visreg
visreg(gam1,"date", scale = "response")
visreg(gam1,"date", by="relationship",scale = "response")
shiny::runApp()
library(tidyverse)
library(readxl)
library(mgcv)
library(visreg)
negs = read_excel("negative_code.xlsx")
negs %>% filter(variant != "/") %>% mutate(variant_y = ifelse(variant=="D",1,0)) -> negs
gam1 = gam(variant_y ~ s(date)+relationship, family="binomial", data=negs)
log1 = glm(variant_y~date+relationship, family="binomial",data=negs)
saveRDS(log1,file="log1.rds")
saveRDS("negs",file="negs.RDS")
runApp()
saveRDS("negs",file="negs.rds")
saveRDS("negs",file="negs.rds")
runApp()
runApp()
runApp()
runApp()
dplyr::bind_rows(
dplyr::mutate(nonlinear$fit, Model = "GAM"),
dplyr::mutate(linear$fit, Model = "Logistic")
) -> fits
nonlinear <- visreg(gam1,  scale='response', "date", line.par = list(col = 'red'), plot=FALSE)
linear <- visreg(log1,  scale='response', "date", plot = FALSE)
dplyr::bind_rows(
dplyr::mutate(nonlinear$fit, Model = "GAM"),
dplyr::mutate(linear$fit, Model = "Logistic")
) -> fits
saveRDS(fits,file="fitmodels.rds")
runApp()
runApp()
runApp()
runApp()
runApp()
